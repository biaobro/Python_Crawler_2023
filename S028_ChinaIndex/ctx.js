/*
@File               : ctx.js
@Project            : S028_ChinaIndex
@CreateTime         : 2023/3/13 16:08
@Author             : biaobro
@Software           : PyCharm
@Last Modify Time   : 2023/3/13 16:08 
@Version            : 1.0
@Description        : None
*/

const CryptoJS = require('crypto-js')
const crypto = require('crypto')

function aseDecrypt(data, lastFetchTime){
    // 这里用到的是AES解密
    // i 是 密钥
    // a 是 偏移量
    // 在这里，i 和 a 的值是相同的，得到的结果都是1个字典，内部包括1个字节数组，和1个sigBytes 变量
    const i = CryptoJS.enc.Utf8.parse(lastFetchTime + '000'),
        a = CryptoJS.enc.Utf8.parse(lastFetchTime + '000'),

        // 这是AES解密固定写法
        s = CryptoJS.AES.decrypt(data.toString(), i, {iv: a}).toString(CryptoJS.enc.Utf8).toString();
    return JSON.parse(s)
}

const eTest = {
    "data": "oYDC86KI14r+2AHfa+0dM3Njtp4afF3VHY1mhrisGVcMckqcmtFkCYC+NKyt3Gb955iakKUFPz4XObFZmUFFAirOuWbuQbUcFMzbRy5e+MHO2XHed4mATfPLyxQzEE1o8xSEbT4N4aq+nalvk3GcgrAlBJCwH7Jjmq9dm8fn1fSxP8fMQ3Q3LsGqib3V3Y8Mds49CurEACjluVmbjhLGLvkFZvUJDAl9kCVgCLpjnYeVUcGDwXHGsCwMDVOh2HRRSqj5vJxz9XYxS98+aIt9WAQiti9S+du0b81E3vjoHmyums9ACbNBfLPgYwsiEoN2QuWtfR86oOjolwBGfyi/rRowm0UIZAQ4DF9yd8pZ7V89k5CsA3zTexMom48KEdNki3q3wrQ2U+Wcqbwr/+4ww7vvKHXOaqSXB0QVyyUHmWOEj3V4WwwXd5kUpCfLNsjtUfbKUgutFjAUpZOdsd4z+Opxd4bWFqsBdyZO28RTuPInAHRJyO0gcNP4rsg1NH+rmgy768PPazJ18uoGdWIYM9vspTKlN/WLdYepWU5NwieCsINSFAq0f7IG0C6LPn1mWOfuz7Bj8sN2CqhpHQ1obieuY2wmYLriTjRucrKNp7C/4OYPfYsZBtSYpJehf+UpK4dbheSZN41/4pfiQXBOaNgfJ66Lhfkz5jnHDKGMgp2cKg3RiSf3APSmeSpJNkCfiM/mXORwuLmuYGNgUpK4uYwvuCfV93ssElX6LchqpxvjCI/aDv+cUCJDCLh3zjYHfbV3Zs+NFZABl63HYbdA83KaNLAmXs2Z/Zuj4NpNNsORZ8+KrG1X23ztBvtG79Py5W3s5q6P2QSRrRN47YQ43AKB2zU39P9eMIGtpsD+Q0TED93vMv8BcYWtK6pIbfVxRKGazGYLyusFcTJgLDDqPaMtVFiYEU0wixslNdpW9ETgnd4rx2/Sl0PwayBIaJcqv9SIR3r+rddRJA2cQ7z+UzQY6+fzi0hFexGtXI+yZXubZ7iuMphF7NNsp+V+rUXGjCC0j95ApMYgJ1rk6sX8e1my/188YQErNWfgamvwiOcxJh8+WWTdlTbpEIoCh/pfwabAeW9jHiOAYgTJ9oT96fUoO6uVPfpHJ6StDuobcV7elryiXBLHtNgi2tS2gC1LCK1N/7Yg250JIXI/d0PD3H/2YO2zvj4og/6hhkhb6UBCdd3vBH0JK4JSHNzPEgpqxToe6Os8vaYqpxSr491Z0Fw79SqkqrL/sz44AAmgZ4s48XOwPrqO7Y3ZVh8FeixXMA+CRCgBBN4CIdmBQoO24jvpvVI5CzUjjr7UMJJNGRDIRZTp84YEoZhmSn9ZI9wFKfspPMDRI7vBV1QIIXNVWga+QiCLlAHwtJeX9wPi86Nw4b23F6W/sJThivXLxzwQ8T8qPdnWqAqXbP7gBs0KZomysB70YAGBaiWlzKFywpcpZyCx3ubNAIhve1TBoKtWkVFPgZnxV92XpFTpCcdae/u0MIlA/lXwuVHr6AKdHDUa9T2b6/Q6XlPA7wDa1FigDBcc/iJf1rSIAXBVr/yxcXAofdWEuAgGEWLgXk2vzrGgQrZbJ2eGgc0evjZz33qW/0vEipD5VxLXX8sost13RGZ29qAuryeEyQYExUvyUCOlQvoZiRn2Z4neCimUNZRYTJIMwe6FBSRyyna63lfqbKImo2nadJXCiQAXQWD2MyAms3fzsX2XUuOX76HsUqrwIs+tT6hDswdZvabIMUf9NHEF9eG0aEhV5lp2LRnZq57KvFpCE9ex+/sxB2fXlzMAv5aCIGRAVEwPl1R2y80+5NUiygd86Ns1QXQ78L+ust0PgBmoLhg5u1rh0gNBM60IMdrarE/ZHgu5rOq0SoaaD08V+rwPnpIK8AEoUeewQR6bTMfI07J9Mms+hWJaz5jAPZrUYpwoKliJDlwx7aoJAtO0f0Sv7RfwRA5ICYjl/pYYI6LZK2DrIlUG/X/YHXXggRQaVF3GLmXPho+GEqqyHhnAa2I0Ti6+5jUGtYXUMWwjnUMxLXqvJz3ulJTrrCHp1YOY2DeEw5igoMrJ4HWZL8TmU1KaStt9we1wdPxmSUi2U8ApABpvo3XOxFK7Aq2QEGmph/LBM8PrB5Xh8qWu3SXrAKCmbQDBEYWNwYn0JU3ZuVk20H6zRaWvILoG1BNSeYuSgw6gmJqW8GRgc+lUWLPb09jwws+DLmFbw9NR5lKVX6LsQCBUcIxDMpgPhESPkehRd03m0fnChCoFQhUoew/v/86fgAxF34ZqgvbCC98+EwzjbA3WPVbuzBXMrZP5CyTVECQYe4nlKJSaSnrYyATArdUiuw6Ya3TK7MD+QThqqalK+i6sSEV60Uz6rrGwrOjoS5LvFzBsLX5ZcKti2hkfzDnrHrhBSgjUuT3+ULYGSp3If+1ao0H7fYzzAgJuOeXbSZgc53V/ZUTqd9o1NaXH2ym2syUbVOeiIiCUMS4JpxlXaGez0KF82bz/KPDintw9vzYYue2QSPdui+iTzSLbzvp4rWcJGJ2hurOlt/swSzCjmVAUBfXxwsI8tr3fgJ5pW94XGRvXqw5BpdK/e7BMa7O7BAUk18X/fQr+upT/rf3BqifM8oDqzN/odakI3eJBdPz2R0cvn1LirhX4YGWga1aikgOpOXzygleWcoFDLmQTDdkh3MOMRV+levX/ZkP++xhWRrjvT44q/TKQ8wm2JFcER3V0O56PbQZvymOAxDNMP+7dv+s1bIq1jfRqKJKgRdSH0Y7n7Y52nKbZGlk9Y8EEu6Qp5rTyAl2uxAkwwh/B6eT88zERkYH1YfxDHoSF2+BbPM0Ez6axZ1FuXc+Pl5HdP8iWMCMTVAC5vGFQ7HYxKssdN6B5Lo2808lPgal7b6YAygSs8Q9Pc7h1X3pXEzrqdPc5tyiZU0mt087U/hfkKw/DB+WXGMorGg8ZzrXrdK6/Vy57p5V98SrB+h6eOE3I7qd+wPpHIKEVr9NBkz2tMNw6UmNHJumYZON9LPjsXBOY+RQyykfazl9Py4lZVv/Dvj02RAxXWI95Tr5a3xmDR8o9S8fYXAmrSgErdbWMeWewbwIMWlj6M7+RCOFRSJatM7cvk4fzS1zv77ceNlk86qFwyA4fULoJEh8b6seGxfXwbVv/0U7z5WodpsLhX1MlI0WNQ20GVu47arRK3JOLnOV0TZfdkqpUp1bqpaa1mkexkoCKZwij2Rl46f9xsq4XzA6TFLksQ28gNf24ExL1eKZW6evyXWr10hDwWy2FpDv21RqIsyF7K244OMqnFbLaXrdAmyAINrZPol32z7cy/N63IiC+GJyyT77yMu+0BmuGuYg7RZcEn9UMehJWqvK1A7dIs7p2fo6LTR1xXIpWvsFOScEOOkDrrcZKia86YVG+Rqo3/D3uUvV90MCMxYJukeJ2gtEHFSvVkh277r4c7hmka80m0HAJBZHKbk8KHu77N8ZIPB52Y5NuYWNNjdXVeIeT6cBkOGN69/QEWMwruJhtshNpVcPlh/4xMi/uHAv8PyqCtS9G+4yc7k9g9WgTQgGRAyF68M1NgGidfPauBaHwb+X2D76JJwRgCz4Oh+Xbldf6xcmAyKxsMLFXuLJMQE8RDjOLdoHrJcE+cD/hy7nrVO7pyjKgMDLpokHvN1NTKq8n0jAF59yyH8Xh6iWizX+n636XhcDuPCWXBm8RsHyRW/DoHdENzWr9w+dFxKEtjBOnJqd877qKh+p8bKVAbk0J2wMTICS9R0qgPXMYAB50yEuwX+Uo1UQib+U/hOe1TlZbTbT6Cpyjo5lSGc0FrouvvttHLUT44NWtM9/j4RCwVvZUsIySbYambQ4TZFLuLTZQ91id9rkDF/ZU9e8f70sLbjUx7xY75p692JBr6qIFFeDT6wPaXDW5SXA+hai2MQd/sbVnituYXNBrhrnqXSVnOmkLa8R8WcNSbB7sHOXEDClfAWIa8SsAFu1FxYTRgbVWPBhvv/o4BZcm2445AgmNIimVI2qsF7zMgObCtiEOVAB8Ymz+VkdS+NaK9JNv3tAReCAW9xE89uEwYE1t+QCIGvfGHlhDwhLIrjef4Nvjzwez45VqUB3M7ooY6/fYklcz+JNB02fuDtS3kPjffvyZOorJqJY7KOaZIxcLCTT39hrJ6d9v7gHPUJ09yNESJNLL5URX06IED6Y5ydM52bCmS5pUAJ6qAg8Guz6tQjvZBnDKYVR7anPYRL1YhI3whUj01+wIcFFVWtkl8b9cG920140qa2Kjlia61cJ+ssiIeaFZHDf9K134xmFRrhkQx21lp+74+cn5RMDay2YDT80tLvauwIwBcGBxDJwlJVOj/BcaUhuarAhPg9bR56xEy1tay6ewZeOaHsHoxYJYg4Hhmk4xFhkHc5jJuXtrp9JZA6bPVZ28uus2w+sq0bbiC6VUv5Ld5l21cSX1nGlp0VuhLSSgJjMB971ruiAlD0zzVAAORLQFjK1+PxRUBr8ID+LfLYaM5EDzTPJxTyH1G+LQe/5+alwqalYre/tEJbwJm7dl5f/CDajOpwYCPTEU+Two3rctyZ65TXOSnlRIWZ8rxU/eM27Rc7YaX76p0godUnFjjcgbh7qHTfRnMkljQaxa5pHi2RiVhsvaetglWLl6tkRcoSH9nURMC8NUnDg7k5VwtKhM8SCSxfpl1zE//Jk0MsT/IIzjq/6vLrTI7oLxPDxCaiBW9a8VWjQyt7QabUYaWrK7rQep5cxuv77HjFmz9tPG06esgb4pYEdwG1yvU5P07qoKXFdLps+mAbpIx8N9YM61sTATDY9BQk9YK2vKViROMmR7ZlbEPjJenRkjszEKsSQmHIxhtRsYRnINjFuG8wBLFa9/bX76Ksw83/K4tMBX7QhSJsvmd8WHC5+aGRBgBZIUgwoRvl5oEJ44EMTCNtrxREHhb6/6GnbHu+rzr30VbrBVt+Eq+LT2+XRFt7kKpXCyiwczZYYDn/Tkc6/KCXoaxYxuUS/s1cycDmL5BgUBALySoQhTUgHswFYPKIghdX+EPMHuVxiGL7YRtha7RvAvYM1bb6BchmBgC/2UHmnRsoAYedasGZrL0FTQrIxFSEjgLqAfvvm8w0uA6wnOtbabDQDhm8A47rvmNrWmgW0OLbE9r8vLJvioXrbhOiO6X6pKMBp+99Vc40UNj82nXmCMPQBAuLYn9e6uGKwklqAnj7JvXeTLTi0728a287Zxe3aSBz/3ltbB4o1SrPRfrUXcz7DhGQGvX8oY1YjmVX9dF1WryOsoTGatv5yC6U9Ebzy0EgNjYMtGJBAgZ7LYDMbv5ZJtuLhRk9aiWTZ6buGfhiNik0v+sZMk04VjQ8o6sfIYK7IQs9NA3lOzsdspLrHOrYl+g4ZaPu163qdB2JQVckIdRMCH+jPQaF1/UinMdOYq/+J6ZuB+FhdjNR7jHwyTto1bsPx27stBIEM3pneCcNY+VXJgA2GBokDNV8HZq6yJrKhDDZxbIa5HEdcUQDESeS+2MIaeWy8yLGVJ60er4kgBmIxe1e9dIgTJduGFyOzzsEkisRgr0+aLv16RB4TjK0iaa21RMvBPSbOUn2qmuNEOzGc69FumB3bIuCt4RI42n7hXTxA3HWeDDdQw8yre+nKet1cgkhxLiMIb5df+lzer221HrNrpG9Py1dhtxpdVRxp51xpv0q/7RKnlxtqhZzBPY5Vu15ivUINE8gdbQb07BcUsiQ6xy+m1MpAJVZXvOGe9e51oB5Rylwu8PYCEFIStsf2byToxROBjJ/hUfgJyE7VoODOluDwcMYxfzwXpI1uMTj5lFwADp8IHleuKiwKdfWrs/VW5Y76Hs+nyv9ynOACRLVku8AiOH+U03mNasN6qUOYvC4dXwc37res9l7IxPhq0Wx5Ha1VudoTdNX2gvAVy5J+SqWRCpEppI+50r+TxwYYh30c8fqTdl1RJxlHHlxXLS/XziD5lLOcZiFK6kbkJUOTm1GJO+TPNlJl4MxZ4Nir60cjH/bzF6FbyAQn3tXHv9a5Vj7K8ZeJhVG7qbbXnoRH7wU1HfQ2reatTc74IIoHrMsRCV/xBgd2HEdrvo4w2r4sTfVggekHXZiWtrcGQItmSzFjsiJrcbsYa0sgK6tdK998UFDkdSLkF2E0p8QkL434SqBwHE0W3YWA2VTMRWn6GvSlixY/IKtXjm4Dnvp1jbV7j+jN5x9E03uPme4pmJt3RUevWmQWGNE4bORIy+z4lpWzWvxl5i8xY47ZSM5qnHpfez9bHJyXdPpbFwWd0L2R5SahhAWkDN9qJ4VkTBYBes3f4V3cg6Wcowa+BHHxQbT8LePZRjuKL/C4/DrjOAayhy0gVtGNFH3o6xBGZ45yMkQuFqGfHM2EsII897kqHpd1Hdkkg0/Fxxwen42asRMlifWMo3RqCPqSdvI23xR0S8eCZlQciLYdwuvGz8ashngsWEOGnXIewJtrH3gzpaagKJg9N6+fhRxgEGkyns/aS9OVNEdh940DVsoFMlX2FwVt403R0l3jCy3bnsuEqZaEuJgdev3lx+um8WFpCTl7DUX3VR1ev+G3AgPhWNH/QHTciY6PWmJgEs4oAoTaRH0boBT825BnTT4sakFdm0MtzSVgLG0tErq/+xKw3q5DLkPtAYr2uT0iIssVCl//W3l8wntf3GF3kvWY3KxgoK6XEGtvagrl5lKUTTxvBQUpAOmqBZB82PRFlYZz6tGapDkLaWHBMumISOzTTNuPiKu7NzwgIF9uOv+Jw+hPWiE/3Bzt+z3GNwGcpyOTLCLUiwTSFVFQuO8nmgMUUWztYu4FssTc3aD3VIwc31raXetzMelNUG3TZf0PQ8LqFFCyBLY1rRvfD6VfXybVSQ2TOrbNMbFSKpQpLcHNjwYSX/IgFZCIbhJMxhZYzX0G6Bj4F9DAyL2P4+HtfpyyQBc4mqeJiSXXHS68es2ak5YuxXs0gPmP48UXoNcB5eAW7o2xDw2vhiy8wVTXMTKY+ekP2nh2/Yt54lu0A8JHCqi+NewK/CPkFMFUxiSyw8/FWQdqtWWPL2RfWZeexJCnpEG/zwbgJhenUkR6ss6t6DFGPvJjHvQCz/HZ5I/weTEnWaFA9Xbe3Oeox6HNeBE8DPS6aa2Gu456F3C/XKQPJ55uLLT/EiDlAjfeJvmNTIf9I+uBeZdz7f29JQdlbs7or7qj6wtx/YutKO8Y5W+eVhWoVhannterBD5WAVgkOKt8IVWFu57h172SVqKYEYn8Depp4kwolZnrTzrOyd6k793vpWAFXGEXF+tGZyJElxeQh4GtTE3/BtVS6dne4kLQDXoWcLkz8L8Rkh6JbE/Me4G5hNv4BR8c27Tm6b1fehMMn8q+lKvWcshUhvr/qbfOmuXwNK936mSiPXKQedJoxrqHgPSXSc+S0nnaavv2zXhPOdAHUydNSyKn8Eko59v/h4lYdHW7WI/gQFV5Nvz+ubEqwIn5vpn1TTROJkffLNX5woO9aDdo2LF86gfi93yFbe1XxtHNs+Acf1EK5r6B2C8ofea29mNCjU3y/yRTGu/y64EnVHOJ4SrZi5CR0YYY+BKTe6Pqg8X2YtKTAlgHBUVr7iw4E1T1iCs7cuUgrLIPg2KjKOpaYVJZFXtpHsTtdz7QvTWnMMCEqme0fKTxT0iNniTf0+9iTPfXLdz7i+2L2WlIeeIUroSfGCyVASzdu6uZ7F5/qzvRgqOUcgXRTLF6joZmUyW+/t7ij/UNoxjNoQMwqnrk6/0nV9XVkW9MjxiBY+lBhUa8rsO9rOigJKJarezQSOXsbcI9thyZGSIFx1hZbSCw0dEaedouWNCR32OP6CaTGYPKHbaTrdfB2wHE4DBoP+7VofLDsS6Hwm/XoRQtHIG1HmeqpmYFSq8aJ2ius24sJY3fOIhVHLttgpHErP0RSKOsh44//T9+ov1F1xZcXM0GL8GiAhq2FsBIyKQBdtNzqKHTLqrsR706gPUnY9UW6ru6u/zruSDbC2RnuFHff21prgmcLz3VOEwL1UWuKYh4AOQ8ikvHJbQBDHXqo5O/lArCs6fyCefI1TIin2Xscw4mvE3CCk3D7lytZG+WC+BT+wXlNPKguYJQFOI9u3mtmthys2mbS12ehyYopCPrGKzXDsircyH94w8BG2M6w3q3CY6Fz2tp1KNR9u95WgoRsH1gGHWxBDW8s9LoIlFHnwLWJewEzBcVFgHLCqVnlNEf1AWL25bByj5EtEhyIpJjIHwKfJqdZ9UqTs/2S3uuI18R8tnqr6erlU9QFhxhddXmd4On9E3lh1RkKCs+gn7jLTPlgXEUjQ0SIl+1X32CXuJHLsQmo/loMvekvRsWGz7wvLywEm4v/EqLT698CsTgaSVbCS1Iov9hHN3Wyo9RBNuJG7ngxyGuchY7VTg3k5bivJE4l/MfCToCJjzKXZ7r4kb/grVLWqSrtlUUSJShhWxrquWwPBuJevVwoM3xhdnmVRBB/JSys4CWGlYj3Bjna4rP4jT5aaynCEzJexSiwGYZkK3FISD3MVD82iXE54MIUVJagx62xQgZ2iWVhy42jPckddeCe56QfssPe/wsbqyuS0VakKH8WnHKcaPDqhJ8MWf2JFw04eJV+9eHg7TapIsZp+jab4pzXgvR69m6lxvoQfRhft09kSXq4PCYmQRDWQN+8Z8vtmqmh6Ud944MNyf88OLb2kICyWmMR4E4cpy25BigLv6JChGRCSh7Ch32rBHIAARktyqUr/Kdl1/frL4nyaIQtzlqE9nhUdXF8/kme5LdhDC2H0AvVVvjwXswNa8o6C2gW9aYjg6Amwg1CqcOdzQaOzpMqNEGghyLfFUqNEbUkSDktUjIXNz2DUok7ep0UhEio08dOrnH/Xf1K7VuXIhwZdnVIJlA2anSJGryuyeIEi7RauqxBDmWiWBr+Y8ZCDBnvyfMguuCuJYnZESajj4atKzVtNakku8eCD2kJteKhAHkTqSjOaqzynhXyPlmG7xqSylPaWkRGyDIWp+Y5HqqtVflpGvWueCRzxSppz2vgGQYNqX1E5/lAUFMxh6su4RYKHHSXwue3TmSJDDZSTY/laq4uEZL1fIPzK4NvCWhO83DxSOOSsaTFGy0w/4uriAsUXEzl426RumDec1cKYBzCrkvp632TfGXxjfMsk925TJIfg02FrOzZABcPwOuoIxOvW0OCB5o=",
    "isEncrypt": 1,
    "result": 1,
    "fetchTime": 0,
    "loginStatus": 0,
    "totalNo": 0,
    "residueNum": 0,
    "updatedNum": 0,
    "pageNum": 0,
    "pageLimit": 0,
    "lastFetchTime": 1678516035095
}
// console.log(aseDecrypt(e.data, e.lastFetchTime))

// 对于这个case 来讲，e 是固定值为：{"channel": "movielist"}
function getSign(e) {
    delete e.sign;
    for (var t = [], n = Object.keys(e).sort(), r = 0; r < n.length; r++) {
        var i = n[r]
          , a = e[i];
        t.push(i),
        t.push(a)
    }
    t.push("iIndex");
    var s = t.join("_")
        // s 会得到固定值 "channel_movielist_iIndex"
      , c = Vie(s);
    // return c
    return c.toString()
}

// vie() 经过测试，实际是 md5 加密
// 因为输入固定，所以输出也固定，这部分可以直接使用固定值
function Vie(s){
    const hash = crypto.createHash('md5')
    return hash.update(s).digest('hex')
}
// sTest = "channel_movielist_iIndex"
// console.log(Vie(sTest))